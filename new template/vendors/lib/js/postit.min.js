var PostItNote=function(){function n(n,t){var i=this,r;this.parent=n;this.positionField={x:0,y:0};this.canMove=!0;this.canMoveOutside=!1;this.dragging=!1;this.elementField=document.createElement("div");r='\n<div class="pi-note">\n    <div class="pi-note-title">\n        <div class="pi-note-handle-move"><\/div>\n        <input class="pi-note-title-input" />\n        <button class="pi-note-x"><\/button>\n    <\/div>\n    <div class="pi-note-content">\n        <textarea class="pi-note-content-input"><\/textarea>\n    <\/div>\n    <div class="pi-note-handle-resize"><\/div>\n<\/div>\n';this.elementField=this.template(t||r);this.elementField.addEventListener("mousedown",function(n){i.onMouseDown(n)});this.elementField.addEventListener("mousemove",function(n){i.onMouseMove(n)});this.elementField.addEventListener("mouseup",function(n){i.onMouseUp(n)});this.elementField.querySelector(".pi-note-x").addEventListener("click",function(){var n=i.elementField.dispatchEvent(new CustomEvent("close",{cancelable:!0,bubbles:!0,detail:i}));n&&i.remove()});this.elementField.querySelectorAll("input,textarea").forEach(function(n){n.addEventListener("change",function(){i.element.dispatchEvent(new Event("change",{bubbles:!0}))})})}return Object.defineProperty(n.prototype,"board",{get:function(){return this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"element",{get:function(){return this.elementField},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.positionField.x},set:function(n){this.move(n,null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.positionField.y},set:function(n){this.move(null,n)},enumerable:!0,configurable:!0}),n.prototype.move=function(n,t){if(n=typeof n=="undefined"||n==null?this.positionField.x:n,t=typeof t=="undefined"||t==null?this.positionField.y:t,!this.canMoveOutside){var i=this.board.container.clientWidth-this.element.clientWidth,r=this.board.container.clientHeight-this.element.clientHeight;n=Math.max(0,Math.min(i,n));t=Math.max(0,Math.min(r,t))}return this.positionField.x=n,this.positionField.y=t,this.elementField.style.left=n+"px",this.elementField.style.top=t+"px",this.elementField.dispatchEvent(new CustomEvent("move",{bubbles:!0,detail:this})),this},Object.defineProperty(n.prototype,"title",{get:function(){return this.elementField.querySelector(".pi-note-title-input").value},set:function(n){this.elementField.querySelector(".pi-note-title-input").value=n},enumerable:!0,configurable:!0}),n.prototype.setTitle=function(n){return this.title=n,this},Object.defineProperty(n.prototype,"content",{get:function(){return this.elementField.querySelector(".pi-note-content-input").value},set:function(n){this.elementField.querySelector(".pi-note-content-input").value=n},enumerable:!0,configurable:!0}),n.prototype.setContent=function(n){return this.content=n,this},n.prototype.toSerializableObject=function(){return{x:this.positionField.x,y:this.positionField.y,title:this.title,content:this.content,canMove:this.canMove,canMoveOutside:this.canMoveOutside}},n.prototype.remove=function(){return this.parent.removeNote(this)},n.fromSerializableObject=function(t,i,r){var u=new n(i,r);return u.move(t.x,t.y),u.canMove=t.canMove,u.canMoveOutside=t.canMoveOutside,u.title=t.title,u.content=t.content,u},n.prototype.onMouseDown=function(n){this.canMove&&n.target.tagName=="DIV"&&(n.preventDefault(),this.startDragCursor={x:n.clientX,y:n.clientY},this.startDragPos={x:this.positionField.x,y:this.positionField.y},this.dragging=!0)},n.prototype.onMouseMove=function(n){if(this.dragging){if((n.buttons&&1)!=1){this.dragging=!1;return}n.preventDefault();var t={x:n.clientX-this.startDragCursor.x,y:n.clientY-this.startDragCursor.y};this.move(this.startDragPos.x+t.x,this.startDragPos.y+t.y)}},n.prototype.onMouseUp=function(){this.dragging=!1},n.prototype.template=function(n){var t=document.createElement("template");return t.innerHTML=n,t.content.firstElementChild},n}(),PostIt=function(){function n(n){this.containerElement=n;this.notes=[];this.containerElement.classList.add("pi-board")}return Object.defineProperty(n.prototype,"container",{get:function(){return this.containerElement},enumerable:!0,configurable:!0}),n.prototype.addNote=function(n){var t=n||new PostItNote(this);return this.containerElement.appendChild(t.element),t.element.addEventListener("close",function(){}),this.notes.push(t),t},n.prototype.removeNote=function(n){for(var t=0;t<this.notes.length;t++)if(this.notes[t]==n){this.notes.splice(t,1);break}return n.element.remove(),this.container.dispatchEvent(new CustomEvent("note-closed",{bubbles:!0,detail:{note:n,board:this}})),n},n.prototype.clearNotes=function(){for(var i,n=0,t=this.notes;n<t.length;n++)i=t[n],i.element.remove();return this.notes=[],this},n.prototype.toSerializableObject=function(){return{notes:this.notes.map(function(n){return n.toSerializableObject()})}},n.prototype.addSerializableObject=function(n){for(var r,u,t=0,i=n.notes;t<i.length;t++)r=i[t],u=PostItNote.fromSerializableObject(r,this),this.addNote(u);return this},n}();